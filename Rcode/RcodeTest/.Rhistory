title = "n(z,t)/total",
color = "Legend") +
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
show_years <- 142:148
n_freq <- sweep(n, 2, colSums(n),  FUN = "/")
plot_df <- data.frame(z = zmesh, year = n_freq[,show_years])
plot_df <- melt(plot_df, id.vars = 'z', variable.name = 'year')
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_discrete(labels = c("Year 1", "Year 2", "Year 3", "Year 4",
"Year 5","Year 6","Year 7"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
show_years <- 138:144
n_freq <- sweep(n, 2, colSums(n),  FUN = "/")
plot_df <- data.frame(z = zmesh, year = n_freq[,show_years])
plot_df <- melt(plot_df, id.vars = 'z', variable.name = 'year')
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_discrete(labels = c("Year 1", "Year 2", "Year 3", "Year 4",
"Year 5","Year 6","Year 7"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_discrete(
values = c("red", "orange", "yellow", "green", "blue", "indigo", "violet"),
labels = c("Year 1", "Year 2", "Year 3", "Year 4",
"Year 5","Year 6","Year 7"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_discrete(
values = c("red", "orange", "yellow", "green", "blue", "red", "red"),
labels = c("Year 1", "Year 2", "Year 3", "Year 4",
"Year 5","Year 6","Year 7"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_discrete(
values = c("red", "red", "red","red", "red","red", "red"),
labels = c("Year 1", "Year 2", "Year 3", "Year 4",
"Year 5","Year 6","Year 7"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_discrete(
#    values = c("red", "red", "red","red", "red","red", "red"),
labels = c("Year 1", "Year 2", "Year 3", "Year 4",
"Year 5","Year 6","Year 7"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
rainbow(7)
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_discrete(
values = rainbow(7),
labels = c("Year 1", "Year 2", "Year 3", "Year 4",
"Year 5","Year 6","Year 7"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_discrete(
values = rainbow(7))+
#    labels = c("Year 1", "Year 2", "Year 3", "Year 4",
#                                  "Year 5","Year 6","Year 7"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
plot_df
factor(plof_df, levels =c("year.1","year.2","year.3","year.4","year.5",
"year.6", "year.7"))
? factor
factor(plof_df$year, levels =c("year.1","year.2","year.3","year.4","year.5",
"year.6", "year.7"))
factor(plot_df$year, levels =c("year.1","year.2","year.3","year.4","year.5",
"year.6", "year.7"))
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_discrete(
values = rainbow(7))+
#    labels = c("Year 1", "Year 2", "Year 3", "Year 4",
#                                  "Year 5","Year 6","Year 7"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
typeof(rainbow(7))
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year, group=year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_discrete(
values = rainbow(7))+
#    labels = c("Year 1", "Year 2", "Year 3", "Year 4",
#                                  "Year 5","Year 6","Year 7"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
cols <- rainbow(7)
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_manual(
values = cols)+
#    labels = c("Year 1", "Year 2", "Year 3", "Year 4",
#                                  "Year 5","Year 6","Year 7"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_manual(
values = rainbow(7))+
scale_color_discrete(labels = c("Year 1", "Year 2", "Year 3", "Year 4",
"Year 5","Year 6","Year 7"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_manual(
values = rainbow(7))+
#  scale_color_discrete(labels = c("Year 1", "Year 2", "Year 3", "Year 4",
#                                  "Year 5","Year 6","Year 7"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
show_years <- 142:148
n_freq <- sweep(n, 2, colSums(n),  FUN = "/")
plot_df <- data.frame(z = zmesh, year = n_freq[,show_years])
plot_df <- melt(plot_df, id.vars = 'z', variable.name = 'year')
factor(plot_df$year, levels =c("year.1","year.2","year.3","year.4","year.5",
"year.6", "year.7"))
cols <- rainbow(7)
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_manual(
values = rainbow(7))+
#  scale_color_discrete(labels = c("Year 1", "Year 2", "Year 3", "Year 4",
#                                  "Year 5","Year 6","Year 7"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
show_years <- 142:149
n_freq <- sweep(n, 2, colSums(n),  FUN = "/")
plot_df <- data.frame(z = zmesh, year = n_freq[,show_years])
plot_df <- melt(plot_df, id.vars = 'z', variable.name = 'year')
factor(plot_df$year, levels =c("year.1","year.2","year.3","year.4","year.5",
"year.6", "year.7"))
cols <- rainbow(8)
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_manual(
values = rainbow(7))+
#  scale_color_discrete(labels = c("Year 1", "Year 2", "Year 3", "Year 4",
#                                  "Year 5","Year 6","Year 7"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
show_years <- 142:149
n_freq <- sweep(n, 2, colSums(n),  FUN = "/")
plot_df <- data.frame(z = zmesh, year = n_freq[,show_years])
plot_df <- melt(plot_df, id.vars = 'z', variable.name = 'year')
factor(plot_df$year, levels =c("year.1","year.2","year.3","year.4","year.5",
"year.6", "year.7"))
cols <- rainbow(8)
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_manual(
values = rainbow(8))+
#  scale_color_discrete(labels = c("Year 1", "Year 2", "Year 3", "Year 4",
#                                  "Year 5","Year 6","Year 7"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
show_years <- 142:148
n_freq <- sweep(n, 2, colSums(n),  FUN = "/")
plot_df <- data.frame(z = zmesh, year = n_freq[,show_years])
plot_df <- melt(plot_df, id.vars = 'z', variable.name = 'year')
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_manual(
values = rainbow(7))+
#  scale_color_discrete(labels = c("Year 1", "Year 2", "Year 3", "Year 4",
#                                  "Year 5","Year 6","Year 7"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
show_years <- 142:148
n_freq <- sweep(n, 2, colSums(n),  FUN = "/")
plot_df <- data.frame(z = zmesh, year = n_freq[,show_years])
plot_df <- melt(plot_df, id.vars = 'z', variable.name = 'year')
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_manual(
values = rainbow(7),
labels = c("Year 1", "Year 2", "Year 3", "Year 4",
"Year 5","Year 6","Year 7"))+
#  scale_color_discrete(labels = c("Year 1", "Year 2", "Year 3", "Year 4",
#                                  "Year 5","Year 6","Year 7"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_manual(
values = rainbow(7),
labels = c("Year 1", "Year 2", "Year 3", "Year 4",
"Year 5","Year 6","Year 7"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
ggsave("~/Documents/research/gizzard_shad/figures/sim.png")
ggsave("~/Documents/research/gizzard_shad/figures/period.png")
### Age-0 survival vs time
surv_t <- rep(0, times = tf)
for (i in 1:tf) {
surv_t[i] <- surv_age0(n = n[, i], z = zmesh, m_par)
}
plot_df <- tibble(time_years = 1:tf, prob = surv_t[1:tf])
ggplot(data = plot_df,
aes(x = time_years, y = prob)) +
geom_line(color = "blue", size = 1) +
labs(x = "time (in years)",
y = "probability of survival",
title = "Survival Probability of Age-0")+
#       subtitle = paste("Inital Total Density =", n0_total / 1000,
#                        "per m^3")) +
scale_x_continuous(limits = c(5, tf), breaks = seq(0, tf, 5)) +
scale_y_continuous(limits = c(0, .02), breaks = seq(0, 0.2, 0.005)) +
theme_bw() +
theme(text = element_text(size = 16),
aspect.ratio = .7)
plot_df <- tibble(time_years = 1:50, prob = surv_t[1:50])
ggplot(data = plot_df,
aes(x = time_years, y = prob)) +
geom_line(color = "blue", size = 1) +
labs(x = "time (in years)",
y = "probability of survival",
title = "Survival Probability of Age-0")+
#       subtitle = paste("Inital Total Density =", n0_total / 1000,
#                        "per m^3")) +
scale_x_continuous(limits = c(5, tf), breaks = seq(0, tf, 5)) +
scale_y_continuous(limits = c(0, .03), breaks = seq(0, 0.2, 0.005)) +
theme_bw() +
theme(text = element_text(size = 16),
aspect.ratio = .7)
plot_df <- tibble(time_years = 1:100, prob = surv_t[1:100])
ggplot(data = plot_df,
aes(x = time_years, y = prob)) +
geom_line(color = "blue", size = 1) +
labs(x = "time (in years)",
y = "probability of survival",
title = "Survival Probability of Age-0")+
#       subtitle = paste("Inital Total Density =", n0_total / 1000,
#                        "per m^3")) +
scale_x_continuous(limits = c(5, 100), breaks = seq(0, 100, 20)) +
scale_y_continuous(limits = c(0, .03), breaks = seq(0, 0.2, 0.005)) +
theme_bw() +
theme(text = element_text(size = 16),
aspect.ratio = .7)
### Age-0 survival vs time
surv_t <- rep(0, times = tf)
for (i in 1:tf) {
surv_t[i] <- surv_age0(n = n[, i], z = zmesh, m_par)
}
plot_df <- tibble(time_years = 1:100, prob = surv_t[1:100])
ggplot(data = plot_df,
aes(x = time_years, y = prob)) +
geom_line(color = "blue", size = 1) +
labs(x = "time (in years)",
y = "probability of survival",
title = "Survival Probability of Age-0")+
#       subtitle = paste("Inital Total Density =", n0_total / 1000,
#                        "per m^3")) +
scale_x_continuous(limits = c(5, 100), breaks = seq(0, 100, 20)) +
scale_y_continuous(limits = c(0, .04), breaks = seq(0, 0.2, 0.005)) +
theme_bw() +
theme(text = element_text(size = 16),
aspect.ratio = .7)
ggsave("~/Documents/research/gizzard_shad/figures/Figure2a.pdf")
ltrm_gzsd %>%
filter(year < 2107) %>%
filter(pool %in% c("LG")) %>%
ggplot(., aes(x = length)) +
geom_histogram(aes(y = ..density..), bins = 30) +
facet_wrap(~ year, nrow = 4) +
labs(x = "length (in mm)",
y = "length frequency",
title = "Length Frequency",
subtitle = "Upper Mississippi River - La Grange, 1989-2020") +
scale_x_continuous(limits = c(0, u_shad), breaks = seq(0, 500, 200),
expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 0.015), breaks = seq(0, 0.015, 0.005),
expand = c(0, 0))
ggsave("~/Documents/research/gizzard_shad/figures/LTRMlg.png")
plot_average <- tibble(z = zmesh,
year = rep("mean",N),
n_freq = (1/floor(coef(n_total_period)[1]))*rowSums(n_freq[,year_start:year_end]) )
ggplot(data = ltrm_gzsd_lg, aes(x = length_round)) +
geom_histogram(aes(y = ..density..), bins = 50)+
#  geom_density(aes(x = length)) +
geom_line(data = plot_average, aes(x = z, y = n_freq/delta_z))+
labs(x = "length (in mm)",
y = "frequency",
color = "Legend") +
scale_color_manual(breaks=c("a","b"))+
#  theme_bw()+
theme(text = element_text(size=16),
aspect.ratio = .7)
ggsave("~/Documents/research/gizzard_shad/figures/lagrange.pdf")
show_years <- 1:4
n_freq <- sweep(n, 2, colSums(n),  FUN = "/")
plot_df <- data.frame(z = zmesh, year = n_freq[,show_years])
plot_df <- melt(plot_df, id.vars = 'z', variable.name = 'year')
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_manual(
values = rainbow(4),
labels = c("Year 1", "Year 2", "Year 3", "Year 4"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
show_years <- 1:5
n_freq <- sweep(n, 2, colSums(n),  FUN = "/")
plot_df <- data.frame(z = zmesh, year = n_freq[,show_years])
plot_df <- melt(plot_df, id.vars = 'z', variable.name = 'year')
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_manual(
values = rainbow(4),
labels = c("Year 1", "Year 2", "Year 3", "Year 4"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
show_years <- 1:5
n_freq <- sweep(n, 2, colSums(n),  FUN = "/")
plot_df <- data.frame(z = zmesh, year = n_freq[,show_years])
plot_df <- melt(plot_df, id.vars = 'z', variable.name = 'year')
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_manual(
values = rainbow(5),
labels = c("Year 1", "Year 2", "Year 3", "Year 4"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
show_years <- 1:5
n_freq <- sweep(n, 2, colSums(n),  FUN = "/")
plot_df <- data.frame(z = zmesh, year = n_freq[,show_years])
plot_df <- melt(plot_df, id.vars = 'z', variable.name = 'year')
ggplot(plot_df,
aes(z, value)) +
geom_line(aes(color = year)) +
labs(x = "length (in mm)",
y = "relative frequency",
title = "n(z,t)/total",
color = "Legend") +
scale_color_manual(
values = rainbow(5),
labels = c("Year 1", "Year 2", "Year 3", "Year 4","Year 5"))+
theme_bw() +
theme(legend.position = c(0.8, 0.5))+
theme(text = element_text(size=16),
aspect.ratio = .7)
ggsave("~/Documents/research/gizzard_shad/figures/inital_sim.png")
ggsave("~/Documents/research/gizzard_shad/figures/initial_sim.png")
m_par$surv_alpha
m_par$surv_beta
